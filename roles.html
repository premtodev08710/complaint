<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‚Äì Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-check-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <script src="./firebase-config.js"></script>
  <script>
    if (window.APP_CHECK_SITE_KEY) {
      if (!firebase.apps.length) firebase.initializeApp(window.firebaseConfig);
      const provider = new firebase.appCheck.ReCaptchaV3Provider(window.APP_CHECK_SITE_KEY);
      firebase.appCheck().activate(provider, true);
    }
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Sarabun',sans-serif;}
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">

  <!-- Header -->
  <header class="gradient-bg text-white shadow-lg">
    <div class="container mx-auto px-4 py-6">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center">
            <span class="text-2xl">üë•</span>
          </div>
          <div>
            <h1 class="text-2xl font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h1>
            <p class="text-blue-100 text-sm">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö (Admin)</p>
          </div>
        </div>
        <div class="hidden md:flex items-center gap-4">
          <a href="./admin.html" class="hover:text-blue-200 transition-colors">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ Admin</a>
          <a href="./index.html" class="hover:text-blue-200 transition-colors">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
          <span id="adminBadge" class="hidden text-sm bg-white/20 px-3 py-1 rounded-full"></span>
          <button onclick="logout()" class="hover:text-blue-200">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
        <button onclick="document.getElementById('mobileMenu').classList.toggle('hidden')" class="md:hidden text-white" aria-label="‡πÄ‡∏°‡∏ô‡∏π">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <!-- Mobile Menu -->
      <div id="mobileMenu" class="hidden md:hidden mt-4 space-y-2">
        <a href="./admin.html" class="block w-full text-left py-2 hover:text-blue-200">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ Admin</a>
        <a href="./index.html" class="block w-full text-left py-2 hover:text-blue-200">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <span id="adminBadgeMobile" class="hidden block text-sm bg-white/20 px-3 py-1 rounded-full"></span>
        <button onclick="logout()" class="block w-full text-left py-2 hover:text-blue-200">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-6">
    <!-- Guard -->
    <div id="guard" class="hidden bg-red-50 text-red-800 border border-red-200 rounded-lg p-4 mb-6">
      ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‚Äú‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‚Äù (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó <b>‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</b>)
    </div>

    <!-- Filter Card -->
    <section class="bg-white rounded-xl p-5 card-shadow mb-6">
      <div class="grid md:grid-cols-12 gap-4 items-end">
        <div class="md:col-span-5">
          <label class="block text-sm mb-1 text-gray-700">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
          <div class="relative">
            <input id="qEmail" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô student@uni.ac.th"
                   class="w-full border border-gray-300 rounded-lg pl-10 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="11" cy="11" r="8" stroke-width="2"></circle>
              <path d="M21 21l-4.3-4.3" stroke-width="2" stroke-linecap="round"></path>
            </svg>
          </div>
        </div>

        <div class="md:col-span-3">
          <label class="block text-sm mb-1 text-gray-700">‡∏Å‡∏£‡∏≠‡∏á‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</label>
          <select id="fRole" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
            <option value="user">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
            <option value="rector">‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏î‡∏µ</option>
            <option value="board-chairman">‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</option>
            <option value="vice-rector">‡∏£‡∏≠‡∏á‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏î‡∏µ</option>
            <option value="university-council">‡∏™‡∏†‡∏≤‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</option>
            <option value="admin">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</option>
          </select>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm mb-1 text-gray-700">‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</label>
          <select id="pageSize" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option>25</option>
            <option selected>50</option>
            <option>100</option>
          </select>
        </div>

        <div class="md:col-span-2 flex gap-2">
          <button id="btnSearch" class="flex-1 bg-slate-900 text-white rounded-lg px-4 py-2 hover:opacity-90">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤/‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
          <button id="btnReset" class="px-4 py-2 rounded-lg border">‡∏•‡πâ‡∏≤‡∏á</button>
        </div>
      </div>
    </section>

    <!-- Table Card -->
    <section class="bg-white rounded-xl card-shadow overflow-hidden">
      <div class="px-5 py-4 border-b bg-slate-50">
        <h2 class="text-lg font-semibold text-slate-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
        <p class="text-sm text-slate-500">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</p>
      </div>

      <div class="overflow-x-auto">
        <table class="min-w-full">
          <thead class="bg-slate-100 text-slate-700 text-left">
            <tr>
              <th class="px-5 py-3 text-sm font-medium">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</th>
              <th class="px-5 py-3 text-sm font-medium">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
              <th class="px-5 py-3 text-sm font-medium">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
              <th class="px-5 py-3 text-sm font-medium">‡∏Ñ‡∏ì‡∏∞/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
              <th class="px-5 py-3 text-sm font-medium">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</th>
              <th class="px-5 py-3 text-sm font-medium">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
            </tr>
          </thead>
          <tbody id="rows" class="divide-y"></tbody>
        </table>
      </div>

      <div class="px-5 py-4 flex items-center gap-3 border-t bg-white">
        <div class="inline-flex rounded-lg overflow-hidden border">
          <button id="prevBtn" class="px-4 py-2 bg-white hover:bg-slate-50 disabled:opacity-50" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
          <button id="nextBtn" class="px-4 py-2 bg-white hover:bg-slate-50 disabled:opacity-50" disabled>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
        <span id="hint" class="text-sm text-slate-600"></span>
      </div>
    </section>
  </main>

  <!-- Toast -->
  <div id="toastWrap" class="fixed top-5 right-5 space-y-2 z-50"></div>

  <script src="./roles.js"></script>
</body>
</html>
